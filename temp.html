<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a2e; color: #eee; }
        .result { background: #16213e; padding: 15px; margin: 10px 0; border-radius: 5px; white-space: pre-wrap; }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Supabase API Test</h1>

    <p>Anon Key: <code>eyJhbGci...U-o</code></p>

    <h2>Test Endpoints:</h2>
    <button onclick="testEndpoint('https://api.srv936332.hstgr.cloud/rest/v1/app_ratings?select=app_slug,rating')">
        Test HTTPS (no port)
    </button>
    <button onclick="testEndpoint('http://api.srv936332.hstgr.cloud:8000/rest/v1/app_ratings?select=app_slug,rating')">
        Test HTTP:8000
    </button>

    <h2>Results:</h2>
    <div id="results"></div>

    <script>
        const ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiZXhwIjoyMDAwMDAwMDAwfQ.tHSYynNDP7ztszA_LVHm2NPl1xD1PI0FnZXnQbaqU-o';

        async function testEndpoint(url) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += `<div class="result">Testing: ${url}\n`;

            try {
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'apikey': ANON_KEY,
                        'Authorization': 'Bearer ' + ANON_KEY
                    }
                });

                const text = await response.text();

                if (response.ok) {
                    resultsDiv.innerHTML += `<span class="success">SUCCESS (${response.status})</span>\n`;
                    resultsDiv.innerHTML += `Data: ${text.substring(0, 500)}${text.length > 500 ? '...' : ''}\n`;
                } else {
                    resultsDiv.innerHTML += `<span class="error">FAILED (${response.status})</span>\n`;
                    resultsDiv.innerHTML += `Error: ${text}\n`;
                }
            } catch (e) {
                resultsDiv.innerHTML += `<span class="error">EXCEPTION: ${e.message}</span>\n`;
            }

            resultsDiv.innerHTML += `</div>`;
        }

        // Auto-test on load
        window.onload = function() {
            testEndpoint('https://api.srv936332.hstgr.cloud/rest/v1/app_ratings?select=app_slug,rating');
        };
    </script>
</body>
</html>
